(()=>{"use strict";const e=window.wc.blocksCheckout,t=window.React,i=window.wp.element,a=window.wp.data,n=window.wc.wcSettings,s=window.wc.wcBlocksData;function o(e){return e[e.length-1]}function r(e,...t){return t.forEach((t=>{e.includes(t)||e.push(t)})),e}function l(e,t){return e?e.split(t):[]}function c(e,t,i){return(void 0===t||e>=t)&&(void 0===i||e<=i)}function d(e,t,i){return e<t?t:e>i?i:e}function p(e,t,i={},a=0,n=""){const s=Object.keys(i).reduce(((e,t)=>{let n=i[t];return"function"==typeof n&&(n=n(a)),`${e} ${t}="${n}"`}),e);n+=`<${s}></${e}>`;const o=a+1;return o<t?p(e,t,i,o,n):n}function h(e){return e.replace(/>\s+/g,">").replace(/\s+</,"<")}function u(e){return new Date(e).setHours(0,0,0,0)}function m(){return(new Date).setHours(0,0,0,0)}function g(...e){switch(e.length){case 0:return m();case 1:return u(e[0])}const t=new Date(0);return t.setFullYear(...e),t.setHours(0,0,0,0)}function f(e,t){const i=new Date(e);return i.setDate(i.getDate()+t)}function y(e,t){const i=new Date(e),a=i.getMonth()+t;let n=a%12;n<0&&(n+=12);const s=i.setMonth(a);return i.getMonth()!==n?i.setDate(0):s}function k(e,t){const i=new Date(e),a=i.getMonth(),n=i.setFullYear(i.getFullYear()+t);return 1===a&&2===i.getMonth()?i.setDate(0):n}function w(e,t){return(e-t+7)%7}function v(e,t,i=0){const a=new Date(e).getDay();return f(e,w(t,i)-w(a,i))}function b(e,t){return Math.round((e-t)/6048e5)+1}function _(e){const t=v(e,4,1);return b(t,v(new Date(t).setMonth(0,4),4,1))}function D(e,t){const i=v(new Date(e).setMonth(0,1),t,t),a=v(e,t,t),n=b(a,i);return n<53?n:a===v(new Date(e).setDate(32),t,t)?1:n}function E(e){return D(e,0)}function S(e){return D(e,6)}function x(e,t){const i=new Date(e).getFullYear();return Math.floor(i/t)*t}function M(e,t,i){if(1!==t&&2!==t)return e;const a=new Date(e);return 1===t?i?a.setMonth(a.getMonth()+1,0):a.setDate(1):i?a.setFullYear(a.getFullYear()+1,0,0):a.setMonth(0,1),a.setHours(0,0,0,0)}const N=/dd?|DD?|mm?|MM?|yy?(?:yy)?/,C=/[\s!-/:-@[-`{-~年月日]+/;let O={};const L={y:(e,t)=>new Date(e).setFullYear(parseInt(t,10)),m(e,t,i){const a=new Date(e);let n=parseInt(t,10)-1;if(isNaN(n)){if(!t)return NaN;const e=t.toLowerCase(),a=t=>t.toLowerCase().startsWith(e);if(n=i.monthsShort.findIndex(a),n<0&&(n=i.months.findIndex(a)),n<0)return NaN}return a.setMonth(n),a.getMonth()!==T(n)?a.setDate(0):a.getTime()},d:(e,t)=>new Date(e).setDate(parseInt(t,10))},A={d:e=>e.getDate(),dd:e=>F(e.getDate(),2),D:(e,t)=>t.daysShort[e.getDay()],DD:(e,t)=>t.days[e.getDay()],m:e=>e.getMonth()+1,mm:e=>F(e.getMonth()+1,2),M:(e,t)=>t.monthsShort[e.getMonth()],MM:(e,t)=>t.months[e.getMonth()],y:e=>e.getFullYear(),yy:e=>F(e.getFullYear(),2).slice(-2),yyyy:e=>F(e.getFullYear(),4)};function T(e){return e>-1?e%12:T(e+12)}function F(e,t){return e.toString().padStart(t,"0")}function V(e){if("string"!=typeof e)throw new Error("Invalid date format.");if(e in O)return O[e];const t=e.split(N),i=e.match(new RegExp(N,"g"));if(0===t.length||!i)throw new Error("Invalid date format.");const a=i.map((e=>A[e])),n=Object.keys(L).reduce(((e,t)=>(i.find((e=>"D"!==e[0]&&e[0].toLowerCase()===t))&&e.push(t),e)),[]);return O[e]={parser(e,t){const a=e.split(C).reduce(((e,t,a)=>{if(t.length>0&&i[a]){const n=i[a][0];"M"===n?e.m=t:"D"!==n&&(e[n]=t)}return e}),{});return n.reduce(((e,i)=>{const n=L[i](e,a[i],t);return isNaN(n)?e:n}),m())},formatter:(e,i)=>a.reduce(((a,n,s)=>a+`${t[s]}${n(e,i)}`),"")+o(t)}}function B(e,t,i){if(e instanceof Date||"number"==typeof e){const t=u(e);return isNaN(t)?void 0:t}if(e){if("today"===e)return m();if(t&&t.toValue){const a=t.toValue(e,t,i);return isNaN(a)?void 0:u(a)}return V(t).parser(e,i)}}function q(e,t,i){if(isNaN(e)||!e&&0!==e)return"";const a="number"==typeof e?new Date(e):e;return t.toDisplay?t.toDisplay(a,t,i):V(t).formatter(a,i)}const H=document.createRange();function I(e){return H.createContextualFragment(e)}function j(e){return e.parentElement||(e.parentNode instanceof ShadowRoot?e.parentNode.host:void 0)}function Y(e){return e.getRootNode().activeElement===e}function K(e){"none"!==e.style.display&&(e.style.display&&(e.dataset.styleDisplay=e.style.display),e.style.display="none")}function W(e){"none"===e.style.display&&(e.dataset.styleDisplay?(e.style.display=e.dataset.styleDisplay,delete e.dataset.styleDisplay):e.style.display="")}function R(e){e.firstChild&&(e.removeChild(e.firstChild),R(e))}const P=new WeakMap,{addEventListener:$,removeEventListener:J}=EventTarget.prototype;function U(e,t){let i=P.get(e);i||(i=[],P.set(e,i)),t.forEach((e=>{$.call(...e),i.push(e)}))}if(!Event.prototype.composedPath){const e=(t,i=[])=>{let a;return i.push(t),t.parentNode?a=t.parentNode:t.host?a=t.host:t.defaultView&&(a=t.defaultView),a?e(a,i):i};Event.prototype.composedPath=function(){return e(this.target)}}function G(e,t,i){const[a,...n]=e;return t(a)?a:a!==i&&"HTML"!==a.tagName&&0!==n.length?G(n,t,i):void 0}function z(e,t){const i="function"==typeof t?t:e=>e instanceof Element&&e.matches(t);return G(e.composedPath(),i,e.currentTarget)}const Z={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",titleFormat:"MM y"}},X={autohide:!1,beforeShowDay:null,beforeShowDecade:null,beforeShowMonth:null,beforeShowYear:null,clearButton:!1,dateDelimiter:",",datesDisabled:[],daysOfWeekDisabled:[],daysOfWeekHighlighted:[],defaultViewDate:void 0,disableTouchKeyboard:!1,enableOnReadonly:!0,format:"mm/dd/yyyy",language:"en",maxDate:null,maxNumberOfDates:1,maxView:3,minDate:null,nextArrow:"»",orientation:"auto",pickLevel:0,prevArrow:"«",showDaysOfWeek:!0,showOnClick:!0,showOnFocus:!0,startView:0,title:"",todayButton:!1,todayButtonMode:0,todayHighlight:!1,updateOnBlur:!0,weekNumbers:0,weekStart:0},{language:Q,format:ee,weekStart:te}=X;function ie(e,t){return e.length<6&&t>=0&&t<7?r(e,t):e}function ae(e,t){switch(4===e?6===t?3:!t+1:e){case 1:return _;case 2:return E;case 3:return S}}function ne(e,t,i){return t.weekStart=e,t.weekEnd=(e+6)%7,4===i&&(t.getWeekNumber=ae(4,e)),e}function se(e,t,i,a){const n=B(e,t,i);return void 0!==n?n:a}function oe(e,t,i=3){const a=parseInt(e,10);return a>=0&&a<=i?a:t}function re(e,t,i,a=void 0){t in e&&(i in e||(e[i]=a?a(e[t]):e[t]),delete e[t])}function le(e,t){const i=Object.assign({},e),a={},n=t.constructor.locales,s=!!t.rangeSideIndex;let{datesDisabled:o,format:l,language:c,locale:d,maxDate:p,maxView:h,minDate:u,pickLevel:m,startView:f,weekNumbers:y,weekStart:k}=t.config||{};if(re(i,"calendarWeeks","weekNumbers",(e=>e?1:0)),re(i,"clearBtn","clearButton"),re(i,"todayBtn","todayButton"),re(i,"todayBtnMode","todayButtonMode"),i.language){let e;if(i.language!==c&&(n[i.language]?e=i.language:(e=i.language.split("-")[0],n[e]||(e=!1))),delete i.language,e){c=a.language=e;const t=d||n[Q];d=Object.assign({format:ee,weekStart:te},n[Q]),c!==Q&&Object.assign(d,n[c]),a.locale=d,l===t.format&&(l=a.format=d.format),k===t.weekStart&&(k=ne(d.weekStart,a,y))}}if(i.format){const e="function"==typeof i.format.toDisplay,t="function"==typeof i.format.toValue,n=N.test(i.format);(e&&t||n)&&(l=a.format=i.format),delete i.format}let w=m;"pickLevel"in i&&(w=oe(i.pickLevel,m,2),delete i.pickLevel),w!==m&&(w>m&&("minDate"in i||(i.minDate=u),"maxDate"in i||(i.maxDate=p)),o&&!i.datesDisabled&&(i.datesDisabled=[]),m=a.pickLevel=w);let v=u,b=p;if("minDate"in i){const e=g(0,0,1);v=null===i.minDate?e:se(i.minDate,l,d,v),v!==e&&(v=M(v,m,!1)),delete i.minDate}if("maxDate"in i&&(b=null===i.maxDate?void 0:se(i.maxDate,l,d,b),void 0!==b&&(b=M(b,m,!0)),delete i.maxDate),b<v?(u=a.minDate=b,p=a.maxDate=v):(u!==v&&(u=a.minDate=v),p!==b&&(p=a.maxDate=b)),i.datesDisabled){const e=i.datesDisabled;if("function"==typeof e)a.datesDisabled=null,a.checkDisabled=(t,i)=>e(new Date(t),i,s);else{const t=a.datesDisabled=e.reduce(((e,t)=>{const i=B(t,l,d);return void 0!==i?r(e,M(i,m,s)):e}),[]);a.checkDisabled=e=>t.includes(e)}delete i.datesDisabled}if("defaultViewDate"in i){const e=B(i.defaultViewDate,l,d);void 0!==e&&(a.defaultViewDate=e),delete i.defaultViewDate}if("weekStart"in i){const e=Number(i.weekStart)%7;isNaN(e)||(k=ne(e,a,y)),delete i.weekStart}if(i.daysOfWeekDisabled&&(a.daysOfWeekDisabled=i.daysOfWeekDisabled.reduce(ie,[]),delete i.daysOfWeekDisabled),i.daysOfWeekHighlighted&&(a.daysOfWeekHighlighted=i.daysOfWeekHighlighted.reduce(ie,[]),delete i.daysOfWeekHighlighted),"weekNumbers"in i){let e=i.weekNumbers;if(e){const t="function"==typeof e?(t,i)=>e(new Date(t),i):ae(e=parseInt(e,10),k);t&&(y=a.weekNumbers=e,a.getWeekNumber=t)}else y=a.weekNumbers=0,a.getWeekNumber=null;delete i.weekNumbers}if("maxNumberOfDates"in i){const e=parseInt(i.maxNumberOfDates,10);e>=0&&(a.maxNumberOfDates=e,a.multidate=1!==e),delete i.maxNumberOfDates}i.dateDelimiter&&(a.dateDelimiter=String(i.dateDelimiter),delete i.dateDelimiter);let _=h;"maxView"in i&&(_=oe(i.maxView,h),delete i.maxView),_=m>_?m:_,_!==h&&(h=a.maxView=_);let D=f;if("startView"in i&&(D=oe(i.startView,D),delete i.startView),D<m?D=m:D>h&&(D=h),D!==f&&(a.startView=D),i.prevArrow){const e=I(i.prevArrow);e.childNodes.length>0&&(a.prevArrow=e.childNodes),delete i.prevArrow}if(i.nextArrow){const e=I(i.nextArrow);e.childNodes.length>0&&(a.nextArrow=e.childNodes),delete i.nextArrow}if("disableTouchKeyboard"in i&&(a.disableTouchKeyboard="ontouchstart"in document&&!!i.disableTouchKeyboard,delete i.disableTouchKeyboard),i.orientation){const e=i.orientation.toLowerCase().split(/\s+/g);a.orientation={x:e.find((e=>"left"===e||"right"===e))||"auto",y:e.find((e=>"top"===e||"bottom"===e))||"auto"},delete i.orientation}if("todayButtonMode"in i){switch(i.todayButtonMode){case 0:case 1:a.todayButtonMode=i.todayButtonMode}delete i.todayButtonMode}return Object.entries(i).forEach((([e,t])=>{void 0!==t&&e in X&&(a[e]=t)})),a}const ce={show:{key:"ArrowDown"},hide:null,toggle:{key:"Escape"},prevButton:{key:"ArrowLeft",ctrlOrMetaKey:!0},nextButton:{key:"ArrowRight",ctrlOrMetaKey:!0},viewSwitch:{key:"ArrowUp",ctrlOrMetaKey:!0},clearButton:{key:"Backspace",ctrlOrMetaKey:!0},todayButton:{key:".",ctrlOrMetaKey:!0},exitEditMode:{key:"ArrowDown",ctrlOrMetaKey:!0}},de=e=>e.map((e=>`<button type="button" class="%buttonClass% ${e}" tabindex="-1"></button>`)).join(""),pe=h(`<div class="datepicker">\n  <div class="datepicker-picker">\n    <div class="datepicker-header">\n      <div class="datepicker-title"></div>\n      <div class="datepicker-controls">\n        ${de(["prev-button prev-btn","view-switch","next-button next-btn"])}\n      </div>\n    </div>\n    <div class="datepicker-main"></div>\n    <div class="datepicker-footer">\n      <div class="datepicker-controls">\n        ${de(["today-button today-btn","clear-button clear-btn"])}\n      </div>\n    </div>\n  </div>\n</div>`),he=h(`<div class="days">\n  <div class="days-of-week">${p("span",7,{class:"dow"})}</div>\n  <div class="datepicker-grid">${p("span",42)}</div>\n</div>`),ue=h(`<div class="week-numbers calendar-weeks">\n  <div class="days-of-week"><span class="dow"></span></div>\n  <div class="weeks">${p("span",6,{class:"week"})}</div>\n</div>`);class me{constructor(e,t){Object.assign(this,t,{picker:e,element:I('<div class="datepicker-view"></div>').firstChild,selected:[],isRangeEnd:!!e.datepicker.rangeSideIndex}),this.init(this.picker.datepicker.config)}init(e){"pickLevel"in e&&(this.isMinView=this.id===e.pickLevel),this.setOptions(e),this.updateFocus(),this.updateSelection()}prepareForRender(e,t,i){this.disabled=[];const a=this.picker;a.setViewSwitchLabel(e),a.setPrevButtonDisabled(t),a.setNextButtonDisabled(i)}setDisabled(e,t){t.add("disabled"),r(this.disabled,e)}performBeforeHook(e,t){let i=this.beforeShow(new Date(t));switch(typeof i){case"boolean":i={enabled:i};break;case"string":i={classes:i}}if(i){const a=e.classList;if(!1===i.enabled&&this.setDisabled(t,a),i.classes){const e=i.classes.split(/\s+/);a.add(...e),e.includes("disabled")&&this.setDisabled(t,a)}i.content&&function(e,t){R(e),t instanceof DocumentFragment?e.appendChild(t):"string"==typeof t?e.appendChild(I(t)):"function"==typeof t.forEach&&t.forEach((t=>{e.appendChild(t)}))}(e,i.content)}}renderCell(e,t,i,a,{selected:n,range:s},o,r=[]){e.textContent=t,this.isMinView&&(e.dataset.date=a);const l=e.classList;if(e.className=`datepicker-cell ${this.cellClass}`,i<this.first?l.add("prev"):i>this.last&&l.add("next"),l.add(...r),(o||this.checkDisabled(a,this.id))&&this.setDisabled(a,l),s){const[e,t]=s;i>e&&i<t&&l.add("range"),i===e&&l.add("range-start"),i===t&&l.add("range-end")}n.includes(i)&&l.add("selected"),i===this.focused&&l.add("focused"),this.beforeShow&&this.performBeforeHook(e,a)}refreshCell(e,t,i,[a,n]){const s=e.classList;s.remove("range","range-start","range-end","selected","focused"),t>a&&t<n&&s.add("range"),t===a&&s.add("range-start"),t===n&&s.add("range-end"),i.includes(t)&&s.add("selected"),t===this.focused&&s.add("focused")}changeFocusedCell(e){this.grid.querySelectorAll(".focused").forEach((e=>{e.classList.remove("focused")})),this.grid.children[e].classList.add("focused")}}class ge extends me{constructor(e){super(e,{id:0,name:"days",cellClass:"day"})}init(e,t=!0){if(t){const e=I(he).firstChild;this.dow=e.firstChild,this.grid=e.lastChild,this.element.appendChild(e)}super.init(e)}setOptions(e){let t;if("minDate"in e&&(this.minDate=e.minDate),"maxDate"in e&&(this.maxDate=e.maxDate),e.checkDisabled&&(this.checkDisabled=e.checkDisabled),e.daysOfWeekDisabled&&(this.daysOfWeekDisabled=e.daysOfWeekDisabled,t=!0),e.daysOfWeekHighlighted&&(this.daysOfWeekHighlighted=e.daysOfWeekHighlighted),"todayHighlight"in e&&(this.todayHighlight=e.todayHighlight),"weekStart"in e&&(this.weekStart=e.weekStart,this.weekEnd=e.weekEnd,t=!0),e.locale){const i=this.locale=e.locale;this.dayNames=i.daysMin,this.switchLabelFormat=i.titleFormat,t=!0}if("beforeShowDay"in e&&(this.beforeShow="function"==typeof e.beforeShowDay?e.beforeShowDay:void 0),"weekNumbers"in e)if(e.weekNumbers&&!this.weekNumbers){const e=I(ue).firstChild;this.weekNumbers={element:e,dow:e.firstChild,weeks:e.lastChild},this.element.insertBefore(e,this.element.firstChild)}else this.weekNumbers&&!e.weekNumbers&&(this.element.removeChild(this.weekNumbers.element),this.weekNumbers=null);"getWeekNumber"in e&&(this.getWeekNumber=e.getWeekNumber),"showDaysOfWeek"in e&&(e.showDaysOfWeek?(W(this.dow),this.weekNumbers&&W(this.weekNumbers.dow)):(K(this.dow),this.weekNumbers&&K(this.weekNumbers.dow))),t&&Array.from(this.dow.children).forEach(((e,t)=>{const i=(this.weekStart+t)%7;e.textContent=this.dayNames[i],e.className=this.daysOfWeekDisabled.includes(i)?"dow disabled":"dow"}))}updateFocus(){const e=new Date(this.picker.viewDate),t=e.getFullYear(),i=e.getMonth(),a=g(t,i,1),n=v(a,this.weekStart,this.weekStart);this.first=a,this.last=g(t,i+1,0),this.start=n,this.focused=this.picker.viewDate}updateSelection(){const{dates:e,rangepicker:t}=this.picker.datepicker;this.selected=e,t&&(this.range=t.dates)}render(){if(this.today=this.todayHighlight?m():void 0,this.prepareForRender(q(this.focused,this.switchLabelFormat,this.locale),this.first<=this.minDate,this.last>=this.maxDate),this.weekNumbers){const e=this.weekStart,t=v(this.first,e,e);Array.from(this.weekNumbers.weeks.children).forEach(((i,a)=>{const n=f(t,7*a);i.textContent=this.getWeekNumber(n,e),a>3&&i.classList[n>this.last?"add":"remove"]("next")}))}Array.from(this.grid.children).forEach(((e,t)=>{const i=f(this.start,t),a=new Date(i),n=a.getDay(),s=[];this.today===i&&s.push("today"),this.daysOfWeekHighlighted.includes(n)&&s.push("highlighted"),this.renderCell(e,a.getDate(),i,i,this,i<this.minDate||i>this.maxDate||this.daysOfWeekDisabled.includes(n),s)}))}refresh(){const e=this.range||[];Array.from(this.grid.children).forEach((t=>{this.refreshCell(t,Number(t.dataset.date),this.selected,e)}))}refreshFocus(){this.changeFocusedCell(Math.round((this.focused-this.start)/864e5))}}function fe(e,t){if(!e||!e[0]||!e[1])return;const[[i,a],[n,s]]=e;return i>t||n<t?void 0:[i===t?a:-1,n===t?s:12]}class ye extends me{constructor(e){super(e,{id:1,name:"months",cellClass:"month"})}init(e,t=!0){t&&(this.grid=this.element,this.element.classList.add("months","datepicker-grid"),this.grid.appendChild(I(p("span",12,{"data-month":e=>e}))),this.first=0,this.last=11),super.init(e)}setOptions(e){if(e.locale&&(this.monthNames=e.locale.monthsShort),"minDate"in e)if(void 0===e.minDate)this.minYear=this.minMonth=this.minDate=void 0;else{const t=new Date(e.minDate);this.minYear=t.getFullYear(),this.minMonth=t.getMonth(),this.minDate=t.setDate(1)}if("maxDate"in e)if(void 0===e.maxDate)this.maxYear=this.maxMonth=this.maxDate=void 0;else{const t=new Date(e.maxDate);this.maxYear=t.getFullYear(),this.maxMonth=t.getMonth(),this.maxDate=g(this.maxYear,this.maxMonth+1,0)}e.checkDisabled&&(this.checkDisabled=this.isMinView||null===e.datesDisabled?e.checkDisabled:()=>!1),"beforeShowMonth"in e&&(this.beforeShow="function"==typeof e.beforeShowMonth?e.beforeShowMonth:void 0)}updateFocus(){const e=new Date(this.picker.viewDate);this.year=e.getFullYear(),this.focused=e.getMonth()}updateSelection(){const{dates:e,rangepicker:t}=this.picker.datepicker;this.selected=e.reduce(((e,t)=>{const i=new Date(t),a=i.getFullYear(),n=i.getMonth();return void 0===e[a]?e[a]=[n]:r(e[a],n),e}),{}),t&&t.dates&&(this.range=t.dates.map((e=>{const t=new Date(e);return isNaN(t)?void 0:[t.getFullYear(),t.getMonth()]})))}render(){this.prepareForRender(this.year,this.year<=this.minYear,this.year>=this.maxYear);const e=this.selected[this.year]||[],t=this.year<this.minYear||this.year>this.maxYear,i=this.year===this.minYear,a=this.year===this.maxYear,n=fe(this.range,this.year);Array.from(this.grid.children).forEach(((s,o)=>{const r=M(new Date(this.year,o,1),1,this.isRangeEnd);this.renderCell(s,this.monthNames[o],o,r,{selected:e,range:n},t||i&&o<this.minMonth||a&&o>this.maxMonth)}))}refresh(){const e=this.selected[this.year]||[],t=fe(this.range,this.year)||[];Array.from(this.grid.children).forEach(((i,a)=>{this.refreshCell(i,a,e,t)}))}refreshFocus(){this.changeFocusedCell(this.focused)}}class ke extends me{constructor(e,t){super(e,t)}init(e,t=!0){var i;t&&(this.navStep=10*this.step,this.beforeShowOption=`beforeShow${i=this.cellClass,[...i].reduce(((e,t,i)=>e+(i?t:t.toUpperCase())),"")}`,this.grid=this.element,this.element.classList.add(this.name,"datepicker-grid"),this.grid.appendChild(I(p("span",12)))),super.init(e)}setOptions(e){if("minDate"in e&&(void 0===e.minDate?this.minYear=this.minDate=void 0:(this.minYear=x(e.minDate,this.step),this.minDate=g(this.minYear,0,1))),"maxDate"in e&&(void 0===e.maxDate?this.maxYear=this.maxDate=void 0:(this.maxYear=x(e.maxDate,this.step),this.maxDate=g(this.maxYear,11,31))),e.checkDisabled&&(this.checkDisabled=this.isMinView||null===e.datesDisabled?e.checkDisabled:()=>!1),this.beforeShowOption in e){const t=e[this.beforeShowOption];this.beforeShow="function"==typeof t?t:void 0}}updateFocus(){const e=new Date(this.picker.viewDate),t=x(e,this.navStep),i=t+9*this.step;this.first=t,this.last=i,this.start=t-this.step,this.focused=x(e,this.step)}updateSelection(){const{dates:e,rangepicker:t}=this.picker.datepicker;this.selected=e.reduce(((e,t)=>r(e,x(t,this.step))),[]),t&&t.dates&&(this.range=t.dates.map((e=>{if(void 0!==e)return x(e,this.step)})))}render(){this.prepareForRender(`${this.first}-${this.last}`,this.first<=this.minYear,this.last>=this.maxYear),Array.from(this.grid.children).forEach(((e,t)=>{const i=this.start+t*this.step,a=M(new Date(i,0,1),2,this.isRangeEnd);e.dataset.year=i,this.renderCell(e,i,i,a,this,i<this.minYear||i>this.maxYear)}))}refresh(){const e=this.range||[];Array.from(this.grid.children).forEach((t=>{this.refreshCell(t,Number(t.textContent),this.selected,e)}))}refreshFocus(){this.changeFocusedCell(Math.round((this.focused-this.start)/this.step))}}function we(e,t){const i={bubbles:!0,cancelable:!0,detail:{date:e.getDate(),viewDate:new Date(e.picker.viewDate),viewId:e.picker.currentView.id,datepicker:e}};e.element.dispatchEvent(new CustomEvent(t,i))}function ve(e,t){const{config:i,picker:a}=e,{currentView:n,viewDate:s}=a;let o;switch(n.id){case 0:o=y(s,t);break;case 1:o=k(s,t);break;default:o=k(s,t*n.navStep)}o=d(o,i.minDate,i.maxDate),a.changeFocus(o).render()}function be(e){const t=e.picker.currentView.id;t!==e.config.maxView&&e.picker.changeView(t+1).render()}function _e(e){e.setDate({clear:!0})}function De(e){const t=m();1===e.config.todayButtonMode?e.setDate(t,{forceRefresh:!0,viewDate:t}):e.setFocusedDate(t,!0)}function Ee(e){const t=()=>{e.config.updateOnBlur?e.update({revert:!0}):e.refresh("input"),e.hide()},i=e.element;Y(i)?i.addEventListener("blur",t,{once:!0}):t()}function Se(e){be(e)}function xe(e){ve(e,-1)}function Me(e){ve(e,1)}function Ne(e,t){const i=z(t,".datepicker-cell");if(!i||i.classList.contains("disabled"))return;const{id:a,isMinView:n}=e.picker.currentView,s=i.dataset;n?e.setDate(Number(s.date)):function(e,t){const i=e.picker,a=new Date(i.viewDate),n=i.currentView.id,s=1===n?y(a,t-a.getMonth()):k(a,t-a.getFullYear());i.changeFocus(s).changeView(n-1).render()}(e,Number(1===a?s.month:s.year))}function Ce(e){e.preventDefault()}const Oe=["left","top","right","bottom"].reduce(((e,t)=>(e[t]=`datepicker-orient-${t}`,e)),{}),Le=e=>e?`${e}px`:e;function Ae(e,t){if("title"in t&&(t.title?(e.controls.title.textContent=t.title,W(e.controls.title)):(e.controls.title.textContent="",K(e.controls.title))),t.prevArrow){const i=e.controls.prevButton;R(i),t.prevArrow.forEach((e=>{i.appendChild(e.cloneNode(!0))}))}if(t.nextArrow){const i=e.controls.nextButton;R(i),t.nextArrow.forEach((e=>{i.appendChild(e.cloneNode(!0))}))}if(t.locale&&(e.controls.todayButton.textContent=t.locale.today,e.controls.clearButton.textContent=t.locale.clear),"todayButton"in t&&(t.todayButton?W(e.controls.todayButton):K(e.controls.todayButton)),"minDate"in t||"maxDate"in t){const{minDate:t,maxDate:i}=e.datepicker.config;e.controls.todayButton.disabled=!c(m(),t,i)}"clearButton"in t&&(t.clearButton?W(e.controls.clearButton):K(e.controls.clearButton))}function Te(e){const{dates:t,config:i,rangeSideIndex:a}=e;return d(t.length>0?o(t):M(i.defaultViewDate,i.pickLevel,a),i.minDate,i.maxDate)}function Fe(e,t){"_oldViewDate"in e||t===e.viewDate||(e._oldViewDate=e.viewDate),e.viewDate=t;const{id:i,year:a,first:n,last:s}=e.currentView,o=new Date(t).getFullYear();switch(i){case 0:return t<n||t>s;case 1:return o!==a;default:return o<n||o>s}}function Ve(e){return window.getComputedStyle(e).direction}function Be(e){const t=j(e);if(t!==document.body&&t)return"visible"!==window.getComputedStyle(t).overflow?t:Be(t)}class qe{constructor(e){const{config:t,inputField:i}=this.datepicker=e,a=pe.replace(/%buttonClass%/g,t.buttonClass),n=this.element=I(a).firstChild,[s,o,r]=n.firstChild.children,l=s.firstElementChild,[c,d,p]=s.lastElementChild.children,[h,u]=r.firstChild.children,m={title:l,prevButton:c,viewSwitch:d,nextButton:p,todayButton:h,clearButton:u};this.main=o,this.controls=m;const g=i?"dropdown":"inline";n.classList.add(`datepicker-${g}`),Ae(this,t),this.viewDate=Te(e),U(e,[[n,"mousedown",Ce],[o,"click",Ne.bind(null,e)],[m.viewSwitch,"click",Se.bind(null,e)],[m.prevButton,"click",xe.bind(null,e)],[m.nextButton,"click",Me.bind(null,e)],[m.todayButton,"click",De.bind(null,e)],[m.clearButton,"click",_e.bind(null,e)]]),this.views=[new ge(this),new ye(this),new ke(this,{id:2,name:"years",cellClass:"year",step:1}),new ke(this,{id:3,name:"decades",cellClass:"decade",step:10})],this.currentView=this.views[t.startView],this.currentView.render(),this.main.appendChild(this.currentView.element),t.container?t.container.appendChild(this.element):i.after(this.element)}setOptions(e){Ae(this,e),this.views.forEach((t=>{t.init(e,!1)})),this.currentView.render()}detach(){this.element.remove()}show(){if(this.active)return;const{datepicker:e,element:t}=this,i=e.inputField;if(i){const a=Ve(i);a!==Ve(j(t))?t.dir=a:t.dir&&t.removeAttribute("dir"),this.place(),t.classList.add("active"),e.config.disableTouchKeyboard&&i.blur()}else t.classList.add("active");this.active=!0,we(e,"show")}hide(){this.active&&(this.datepicker.exitEditMode(),this.element.classList.remove("active"),this.active=!1,we(this.datepicker,"hide"))}place(){const{classList:e,style:t}=this.element;t.display="block";const{width:i,height:a}=this.element.getBoundingClientRect(),n=this.element.offsetParent;t.display="";const{config:s,inputField:o}=this.datepicker,{left:r,top:l,right:c,bottom:d,width:p,height:h}=o.getBoundingClientRect();let{x:u,y:m}=s.orientation,g=r,f=l;if(n!==document.body&&n){const e=n.getBoundingClientRect();g-=e.left-n.scrollLeft,f-=e.top-n.scrollTop}else g+=window.scrollX,f+=window.scrollY;const y=Be(o);let k=0,w=0,{clientWidth:v,clientHeight:b}=document.documentElement;if(y){const e=y.getBoundingClientRect();e.top>0&&(w=e.top),e.left>0&&(k=e.left),e.right<v&&(v=e.right),e.bottom<b&&(b=e.bottom)}let _=0;"auto"===u&&(r<k?(u="left",_=k-r):r+i>v?(u="right",v<c&&(_=v-c)):u="rtl"===Ve(o)?c-i<k?"left":"right":"left"),"right"===u&&(g+=p-i),g+=_,"auto"===m&&(m=l-a>w&&d+a>b?"top":"bottom"),"top"===m?f-=a:f+=h,e.remove(...Object.values(Oe)),e.add(Oe[u],Oe[m]),t.left=Le(g),t.top=Le(f)}setViewSwitchLabel(e){this.controls.viewSwitch.textContent=e}setPrevButtonDisabled(e){this.controls.prevButton.disabled=e}setNextButtonDisabled(e){this.controls.nextButton.disabled=e}changeView(e){const t=this.currentView;return e!==t.id&&(this._oldView||(this._oldView=t),this.currentView=this.views[e],this._renderMethod="render"),this}changeFocus(e){return this._renderMethod=Fe(this,e)?"render":"refreshFocus",this.views.forEach((e=>{e.updateFocus()})),this}update(e=void 0){const t=void 0===e?Te(this.datepicker):e;return this._renderMethod=Fe(this,t)?"render":"refresh",this.views.forEach((e=>{e.updateFocus(),e.updateSelection()})),this}render(e=!0){const{currentView:t,datepicker:i,_oldView:a}=this,n=new Date(this._oldViewDate),s=e&&this._renderMethod||"render";if(delete this._oldView,delete this._oldViewDate,delete this._renderMethod,t[s](),a&&(this.main.replaceChild(t.element,a.element),we(i,"changeView")),!isNaN(n)){const e=new Date(this.viewDate);e.getFullYear()!==n.getFullYear()&&we(i,"changeYear"),e.getMonth()!==n.getMonth()&&we(i,"changeMonth")}}}function He(e,t,i,a,n,s){if(c(e,n,s))return a(e)?He(t(e,i),t,i,a,n,s):e}function Ie(e,t,i){const a=e.picker,n=a.currentView,s=n.step||1;let o,r=a.viewDate;switch(n.id){case 0:r=f(r,i?7*t:t),o=f;break;case 1:r=y(r,i?4*t:t),o=y;break;default:r=k(r,t*(i?4:1)*s),o=k}r=He(r,o,t<0?-s:s,(e=>n.disabled.includes(e)),n.minDate,n.maxDate),void 0!==r&&a.changeFocus(r).render()}function je(e,t){const{config:i,picker:a,editMode:n}=e,s=a.active,{key:o,altKey:r,shiftKey:l}=t,c=t.ctrlKey||t.metaKey,d=()=>{t.preventDefault(),t.stopPropagation()};if("Tab"===o)return void Ee(e);if("Enter"===o){if(s)if(n)e.exitEditMode({update:!0,autohide:i.autohide});else{const t=a.currentView;t.isMinView?e.setDate(a.viewDate):(a.changeView(t.id-1).render(),d())}else e.update();return}const p=i.shortcutKeys,h={key:o,ctrlOrMetaKey:c,altKey:r,shiftKey:l},u=Object.keys(p).find((e=>{const t=p[e];return!Object.keys(t).find((e=>t[e]!==h[e]))}));if(u){let t;if("toggle"===u?t=u:n?"exitEditMode"===u&&(t=u):s?"hide"===u?t=u:"prevButton"===u?t=[ve,[e,-1]]:"nextButton"===u?t=[ve,[e,1]]:"viewSwitch"===u?t=[be,[e]]:i.clearButton&&"clearButton"===u?t=[_e,[e]]:i.todayButton&&"todayButton"===u&&(t=[De,[e]]):"show"===u&&(t=u),t)return Array.isArray(t)?t[0].apply(null,t[1]):e[t](),void d()}if(!s||n)return;const m=(i,a)=>{l||c||r?e.enterEditMode():(Ie(e,i,a),t.preventDefault())};"ArrowLeft"===o?m(-1,!1):"ArrowRight"===o?m(1,!1):"ArrowUp"===o?m(-1,!0):"ArrowDown"===o?m(1,!0):("Backspace"===o||"Delete"===o||o&&1===o.length&&!c)&&e.enterEditMode()}function Ye(e){e.config.showOnFocus&&!e._showing&&e.show()}function Ke(e,t){const i=t.target;(e.picker.active||e.config.showOnClick)&&(i._active=Y(i),i._clicking=setTimeout((()=>{delete i._active,delete i._clicking}),2e3))}function We(e,t){const i=t.target;i._clicking&&(clearTimeout(i._clicking),delete i._clicking,i._active&&e.enterEditMode(),delete i._active,e.config.showOnClick&&e.show())}function Re(e,t){t.clipboardData.types.includes("text/plain")&&e.enterEditMode()}function Pe(e,t){const{element:i,picker:a}=e;if(!a.active&&!Y(i))return;const n=a.element;z(t,(e=>e===i||e===n))||Ee(e)}function $e(e,t){return e.map((e=>q(e,t.format,t.locale))).join(t.dateDelimiter)}function Je(e,t,i=!1){if(0===t.length)return i?[]:void 0;const{config:a,dates:n,rangeSideIndex:s}=e,{pickLevel:o,maxNumberOfDates:r}=a;let l=t.reduce(((e,t)=>{let i=B(t,a.format,a.locale);return void 0===i||(i=M(i,o,s),!c(i,a.minDate,a.maxDate)||e.includes(i)||a.checkDisabled(i,o)||!(o>0)&&a.daysOfWeekDisabled.includes(new Date(i).getDay())||e.push(i)),e}),[]);return 0!==l.length?(a.multidate&&!i&&(l=l.reduce(((e,t)=>(n.includes(t)||e.push(t),e)),n.filter((e=>!l.includes(e))))),r&&l.length>r?l.slice(-1*r):l):void 0}function Ue(e,t=3,i=!0,a=void 0){const{config:n,picker:s,inputField:o}=e;if(2&t){const e=s.active?n.pickLevel:n.startView;s.update(a).changeView(e).render(i)}1&t&&o&&(o.value=$e(e.dates,n))}function Ge(e,t,i){const a=e.config;let{clear:n,render:s,autohide:o,revert:r,forceRefresh:l,viewDate:c}=i;void 0===s&&(s=!0),s?void 0===o&&(o=a.autohide):o=l=!1,c=B(c,a.format,a.locale);const d=Je(e,t,n);(d||r)&&(d&&d.toString()!==e.dates.toString()?(e.dates=d,Ue(e,s?3:1,!0,c),we(e,"changeDate")):Ue(e,l?3:1,!0,c),o&&e.hide())}function ze(e,t){return t?i=>q(i,t,e.config.locale):e=>new Date(e)}class Ze{constructor(e,t={},i=void 0){e.datepicker=this,this.element=e,this.dates=[];const a=this.config=Object.assign({buttonClass:t.buttonClass&&String(t.buttonClass)||"button",container:null,defaultViewDate:m(),maxDate:void 0,minDate:void 0},le(X,this));let n;if("INPUT"===e.tagName?(n=this.inputField=e,n.classList.add("datepicker-input"),t.container&&(a.container=t.container instanceof HTMLElement?t.container:document.querySelector(t.container))):a.container=e,i){const e=i.inputs.indexOf(n),t=i.datepickers;if(e<0||e>1||!Array.isArray(t))throw Error("Invalid rangepicker object.");t[e]=this,this.rangepicker=i,this.rangeSideIndex=e}this._options=t,Object.assign(a,le(t,this)),a.shortcutKeys=function(e){return Object.keys(ce).reduce(((t,i)=>{const a=void 0===e[i]?ce[i]:e[i],n=a&&a.key;if(!n||"string"!=typeof n)return t;const s={key:n,ctrlOrMetaKey:!!(a.ctrlOrMetaKey||a.ctrlKey||a.metaKey)};return n.length>1&&(s.altKey=!!a.altKey,s.shiftKey=!!a.shiftKey),t[i]=s,t}),{})}(t.shortcutKeys||{});const s=l(e.value||e.dataset.date,a.dateDelimiter);delete e.dataset.date;const o=Je(this,s);o&&o.length>0&&(this.dates=o),n&&(n.value=$e(this.dates,a));const r=this.picker=new qe(this),c=[e,"keydown",je.bind(null,this)];n?U(this,[c,[n,"focus",Ye.bind(null,this)],[n,"mousedown",Ke.bind(null,this)],[n,"click",We.bind(null,this)],[n,"paste",Re.bind(null,this)],[document,"mousedown",Pe.bind(null,this)],[window,"resize",r.place.bind(r)]]):(U(this,[c]),this.show())}static formatDate(e,t,i){return q(e,t,i&&Z[i]||Z.en)}static parseDate(e,t,i){return B(e,t,i&&Z[i]||Z.en)}static get locales(){return Z}get active(){return!(!this.picker||!this.picker.active)}get pickerElement(){return this.picker?this.picker.element:void 0}setOptions(e){const t=le(e,this);Object.assign(this._options,e),Object.assign(this.config,t),this.picker.setOptions(t),Ue(this,3)}show(){if(this.inputField){const{config:e,inputField:t}=this;if(t.disabled||t.readOnly&&!e.enableOnReadonly)return;Y(t)||e.disableTouchKeyboard||(this._showing=!0,t.focus(),delete this._showing)}this.picker.show()}hide(){this.inputField&&(this.picker.hide(),this.picker.update().changeView(this.config.startView).render())}toggle(){this.picker.active?this.inputField&&this.picker.hide():this.show()}destroy(){this.hide(),function(e){let t=P.get(e);t&&(t.forEach((e=>{J.call(...e)})),P.delete(e))}(this),this.picker.detach();const e=this.element;return e.classList.remove("datepicker-input"),delete e.datepicker,this}getDate(e=void 0){const t=ze(this,e);return this.config.multidate?this.dates.map(t):this.dates.length>0?t(this.dates[0]):void 0}setDate(...e){const t=[...e],i={},a=o(e);!a||"object"!=typeof a||Array.isArray(a)||a instanceof Date||Object.assign(i,t.pop()),Ge(this,Array.isArray(t[0])?t[0]:t,i)}update(e=void 0){if(!this.inputField)return;const t=Object.assign(e||{},{clear:!0,render:!0,viewDate:void 0});Ge(this,l(this.inputField.value,this.config.dateDelimiter),t)}getFocusedDate(e=void 0){return ze(this,e)(this.picker.viewDate)}setFocusedDate(e,t=!1){const{config:i,picker:a,active:n,rangeSideIndex:s}=this,o=i.pickLevel,r=B(e,i.format,i.locale);void 0!==r&&(a.changeFocus(M(r,o,s)),n&&t&&a.changeView(o),a.render())}refresh(e=void 0,t=!1){let i;e&&"string"!=typeof e&&(t=e,e=void 0),i="picker"===e?2:"input"===e?1:3,Ue(this,i,!t)}enterEditMode(){const e=this.inputField;e&&!e.readOnly&&this.picker.active&&!this.editMode&&(this.editMode=!0,e.classList.add("in-edit"))}exitEditMode(e=void 0){if(!this.inputField||!this.editMode)return;const t=Object.assign({update:!1},e);delete this.editMode,this.inputField.classList.remove("in-edit"),t.update&&this.update(t)}}const Xe=window.lodash,{addon_url:Qe,pickup_location_ajax_url:et,pickup_location_ajax_nonce:tt,pickup_location_anchor_text:it,pickup_location_google_map_base_url:at,pickup_location_modal_text_zipcode:nt,pickup_location_modal_text_city:st,pickup_location_modal_text_street:ot,pickup_location_modal_text_search:rt,pickup_location_modal_text_select:lt,pickup_location_modal_text_packstation:ct,pickup_location_modal_text_address:dt,pickup_location_modal_text_opening_hours:pt,pickup_location_modal_text_monday:ht,pickup_location_modal_text_tuesday:ut,pickup_location_modal_text_wednesday:mt,pickup_location_modal_text_thursday:gt,pickup_location_modal_text_friday:ft,pickup_location_modal_text_saturday:yt,pickup_location_modal_text_sunday:kt,pickup_location_modal_text_contact:wt}=(0,n.getSetting)("german-market-blocks_data");class vt extends t.Component{constructor(e){super(e),this.state={postcode:"",city:"",street:"",country:"",locked:!1,locations:{},locationType:this.props.locationType,google_map:{}}}componentDidMount(){let e=document.getElementById("parcel-modal"),t=this;document.getElementById("show-parcel-modal").addEventListener("click",(function(i){i&&i.preventDefault();const n=(0,a.select)(s.CART_STORE_KEY).getCartData();t.setState({postcode:n.shippingAddress.postcode,city:n.shippingAddress.city,street:n.shippingAddress.address_1,country:n.shippingAddress.country},(()=>{document.querySelector('input[name="modal-postcode"]').value=t.state.postcode,document.querySelector('input[name="modal-city"]').value=t.state.city,document.querySelector('input[name="modal-address"]').value=t.state.street,document.querySelector('input[name="modal-country"]').value=t.state.country,t.initMap(),e.style.display="block",document.body.style.overflow="hidden"}))})),document.getElementById("close-parcel-modal").addEventListener("click",(function(t){t&&t.preventDefault(),e.style.display="none",document.body.style.overflow="auto"}))}componentDidUpdate(e,t,i){}componentWillUnmount=()=>{};onSearchLocationClick=e=>{e&&e.preventDefault(),this.setState({postcode:document.querySelector('input[name="modal-postcode"]').value,city:document.querySelector('input[name="modal-city"]').value,street:document.querySelector('input[name="modal-address"]').value,country:document.querySelector('input[name="modal-country"]').value}),""!==this.state.postcode&&""!==this.state.street&&""!==this.state.city&&this.setGeocodedAddress()};setGeocodedAddress(){let e=this;if(!e.props.googleMapKey)return void console.log("Postal code geocoder is missing Google Maps API key");if(""===e.props.provider)return void console.log("Could not determinate shipping provider");let t="get_"+e.props.provider+"_parcels_modal";"packstation"===e.props.locationType&&(t="get_"+e.props.provider+"_packstations_modal"),fetch(et.toString().replace("%%endpoint%%",t),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({action:t,postcode:e.state.postcode,city:e.state.city,street:e.state.street,country:e.state.country})}).then((e=>e.json())).then((e=>{this.setTerminalMarkers(e),this.setState({locations:e})}),(e=>{this.setState({locations:{}}),console.log(e)}));var i=at+"?"+new URLSearchParams({address:e.state.postcode+" "+e.state.city+" "+e.state.street,type:"street_address",key:e.props.googleMapKey});fetch(i).then((e=>e.json())).then((t=>{if("OK"==t.status){var i=this.getCoordinatesFromJson(t);i?(e.state.google_map.myLocation=i,e.state.google_map.map.myMarker.setPosition(e.state.google_map.myLocation),e.state.google_map.map.setZoom(15),e.state.google_map.map.panTo(e.state.google_map.myLocation),setTimeout((function(){e.state.google_map.map.setZoom(14)}),1e3)):console.log("Cannot geocode coordinates from address")}else console.log("Google Maps Geocoder Error",t)}))}setTerminalMarkers=e=>{let t=this;if(t.state.google_map.markers.length>0){for(var i=0;i<t.state.google_map.markers.length;i++)t.state.google_map.markers[i].setMap(null);t.state.google_map.markers=[]}var a,n;for(i=0;i<e.length;i++){n=e[i];try{(a=new google.maps.Marker({position:{lat:parseFloat(n.latitude),lng:parseFloat(n.longitude)},map:t.state.google_map.map,icon:Qe+"/includes/provider/"+t.props.provider+"/assets/images/point.png"})).terminal=this.extend({},n),google.maps.event.addListener(a,"click",(function(){this.hasOwnProperty("terminal")&&t.showMarkerInfo(this)})),t.state.google_map.markers.push(a)}catch(e){console.log("Cannot create marker for terminal",n)}}new MarkerClusterer(this.state.google_map.map,this.state.google_map.markers,{imagePath:Qe+"m",maxZoom:13,minimumClusterSize:1})};decodeEntities(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value}getCoordinatesFromJson(e){var t;try{t=e.results[0].geometry.location}catch(e){}return t}onSelectTerminalClick=e=>{let t=this;e&&e.preventDefault();var i=document.getElementsByClassName("select-terminal")[0],a=i.dataset.terminalCode,n=i.dataset.terminalTitle,s=i.dataset.method,o=i.dataset.cod;if(t.state.locked)return;t.state.locked=!0;let r="choose_"+t.props.provider+"_terminal";fetch(et.toString().replace("%%endpoint%%",r),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({action:r,is_backend_modal:!1,terminal_field:s,terminal:a,terminal_details:{id:a,company:i.dataset.terminalCompany,street:i.dataset.terminalStreet,pcode:i.dataset.terminalPostcode,city:i.dataset.terminalCity},cod:o,security:tt})}).then((e=>e.json())).then((e=>{t.state.locked=!1,t.props.setTerminal(a),document.getElementById("selected-parcel").innerHTML=n,this.props.updateHandler("pickup_location",a),document.getElementById("close-parcel-modal").click()}),(e=>{t.state.locked=!1,console.log(e)}))};showMarkerInfo(e){let t=this;var i=e.terminal;if(t.state.google_map.marker_info=document.getElementById("parcel-modal-info"),t.state.google_map.marker_info.style.display="none","parcels"!=t.props.locationType)var a=t.state.google_map.marker_info.querySelector(".packstation-id");else(a=t.state.google_map.marker_info.querySelector(".packstation-id")).parentElement.style.display="none";var n=t.state.google_map.marker_info.querySelector("h3"),s=t.state.google_map.marker_info.querySelector(".info-address"),o=t.state.google_map.marker_info.querySelector(".working-hours-wrapper"),r=t.state.google_map.marker_info.querySelector(".mon"),l=t.state.google_map.marker_info.querySelector(".tue"),c=t.state.google_map.marker_info.querySelector(".wed"),d=t.state.google_map.marker_info.querySelector(".thu"),p=t.state.google_map.marker_info.querySelector(".fri"),h=t.state.google_map.marker_info.querySelector(".sat"),u=t.state.google_map.marker_info.querySelector(".sun"),m=t.state.google_map.marker_info.querySelector(".info-phone"),g=t.state.google_map.marker_info.querySelector(".info-email"),f=t.state.google_map.marker_info.querySelector(".select-terminal");if("parcels"!=t.props.locationType&&(a.innerHTML=i.parcelshop_id,a.parentElement.style.display="block"),n.innerHTML=i.company,s.innerHTML=i.street+", "+i.pcode+" "+i.city||"-",null==i.mon&&null==i.tue&&null==i.wed&&null==i.thu&&null==i.fri&&null==i.sat&&null==i.sun&&(o.style.display="none"),"parcels"===t.props.locationType){if(null!=i.mon){var y=i.mon.split("|");r.querySelector(".morning").innerHTML=y[0],r.querySelector(".afternoon").innerHTML=y[1]?y[1]:""}else r.style.display="none";if(null!=i.tue){var k=i.tue.split("|");l.querySelector(".morning").innerHTML=k[0],l.querySelector(".afternoon").innerHTML=k[1]?k[1]:""}else l.style.display="none";if(null!=i.wed){var w=i.wed.split("|");c.querySelector(".morning").innerHTML=w[0],c.querySelector(".afternoon").innerHTML=w[1]?w[1]:""}else c.style.display="none";if(null!=i.thu){var v=i.thu.split("|");d.querySelector(".morning").innerHTML=v[0],d.querySelector(".afternoon").innerHTML=v[1]?v[1]:""}else d.style.display="none";if(null!=i.fri){var b=i.fri.split("|");p.querySelector(".morning").innerHTML=b[0],p.querySelector(".afternoon").innerHTML=b[1]?b[1]:""}else p.style.display="none";if(null!=i.sat){var _=i.sat.split("|");h.querySelector(".morning").innerHTML=_[0],h.querySelector(".afternoon").innerHTML=_[1]?_[1]:""}else h.style.display="none";if(null!=i.sun){var D=i.sun.split("|");u.querySelector(".morning").innerHTML=D[0],u.querySelector(".afternoon").innerHTML=D[1]?D[1]:""}else u.style.display="none"}i.phone?m.innerHTML='<a href="tel:'+i.phone+'">'+i.phone+"</a>":m.innerHTML="",i.email?g.innerHTML='<a href="mailto:'+i.email+'">'+i.email+"</a>":g.innerHTML="",i.phone||i.email||(g.innerHTML="-"),f.setAttribute("data-terminal-code",i.parcelshop_id),f.setAttribute("data-terminal-title",i.company+", "+i.street),f.setAttribute("data-terminal-company",i.company),f.setAttribute("data-terminal-street",i.street),f.setAttribute("data-terminal-postcode",i.pcode),f.setAttribute("data-terminal-city",i.city),f.setAttribute("data-terminal-country",i.country),f.setAttribute("data-cod",i.cod),f.addEventListener("click",this.onSelectTerminalClick),document.getElementById("parcel-modal-info").addEventListener("click",(e=>{e&&e.preventDefault(),"A"!=e.target.nodeName&&(t.state.google_map.marker_info.style.display="none")})),t.state.google_map.marker_info.style.display="block",t.state.google_map.map.panTo(e.getPosition())}extend(e,t){var i,a={};for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(a[i]=e[i]);for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(a[i]=t[i]);return a}loadTerminalMarkers(){let e="get_"+this.props.provider+"_parcels";"packstation"===this.props.locationType&&(e="get_"+this.props.provider+"_packstations"),fetch(et.toString().replace("%%endpoint%%",e),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({action:e})}).then((e=>e.json())).then((e=>{this.setTerminalMarkers(e)}))}async initMap(){let e=this;this.onSearchLocationClick(null),navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){e.state.google_map.myLocation={lat:t.coords.latitude,lng:t.coords.longitude}}),(function(){e.state.google_map.myLocation={lat:52.520008,lng:13.404954}})):this.state.google_map.myLocation={lat:52.520008,lng:13.404954},this.state.google_map.markers=[],this.state.google_map.marker_info&&(this.state.google_map.marker_info.style.display="none");const{Map:t}=await google.maps.importLibrary("maps");this.state.google_map.map=new t(document.getElementById("parcel-modal-map"),{center:e.state.google_map.myLocation,zoom:15,maxZoom:17,gestureHandling:"greedy",disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.LEFT_CENTER}}),this.state.google_map.map.myMarker=new google.maps.Marker({position:e.state.google_map.myLocation,map:e.state.google_map.map}),document.querySelector("#parcel-modal .button.search-location").addEventListener("click",this.onSearchLocationClick)}render(){let e=this;return(0,t.createElement)("div",null,(0,t.createElement)("p",{id:"selected-parcel"},this.props.locationInfo),(0,t.createElement)("p",{style:{textAlign:"right"}},(0,t.createElement)("a",{id:"show-parcel-modal",href:"#"},it)),(0,t.createElement)("div",{id:"parcel-modal",className:this.props.locationType},(0,t.createElement)("div",{className:"modal-content"},(0,t.createElement)("span",{className:"close",id:"close-parcel-modal"},"×"),(0,t.createElement)("div",{className:"form-inline"},(0,t.createElement)("div",{className:"form-group"},(0,t.createElement)("input",{name:"modal-postcode",defaultValue:e.state.postcode,type:"text",className:"form-control modal-postcode",placeholder:nt}),(0,t.createElement)("input",{name:"modal-city",defaultValue:e.state.city,type:"text",className:"form-control modal-city",placeholder:st}),(0,t.createElement)("input",{name:"modal-address",defaultValue:e.state.street,type:"text",className:"form-control modal-address",placeholder:ot}),(0,t.createElement)("input",{name:"modal-country",defaultValue:e.state.country,type:"hidden"}),(0,t.createElement)("a",{href:"#",className:"button search-location"},rt))),(0,t.createElement)("div",{className:"modal-map"},(0,t.createElement)("div",{id:"parcel-modal-map"}),(0,t.createElement)("div",{id:"parcel-modal-info"},(0,t.createElement)("div",{className:"info-wrap"},(0,t.createElement)("p",{style:{display:"none"}},ct," #",(0,t.createElement)("span",{className:"packstation-id"})),(0,t.createElement)("h3",null),(0,t.createElement)("p",null,(0,t.createElement)("strong",null,dt),(0,t.createElement)("br",null),(0,t.createElement)("span",{className:"info-address"})),"parcels"==this.props.locationType&&(0,t.createElement)("div",{className:"working-hours-wrapper"},(0,t.createElement)("p",null,(0,t.createElement)("strong",null,pt)),(0,t.createElement)("ul",{className:"working-hours"},(0,t.createElement)("li",{className:"mon"},(0,t.createElement)("span",null,ht,":")," ",(0,t.createElement)("span",{className:"morning"})," ",(0,t.createElement)("span",{className:"afternoon"})),(0,t.createElement)("li",{className:"tue"},(0,t.createElement)("span",null,ut,":")," ",(0,t.createElement)("span",{className:"morning"})," ",(0,t.createElement)("span",{className:"afternoon"})),(0,t.createElement)("li",{className:"wed"},(0,t.createElement)("span",null,mt,":")," ",(0,t.createElement)("span",{className:"morning"})," ",(0,t.createElement)("span",{className:"afternoon"})),(0,t.createElement)("li",{className:"thu"},(0,t.createElement)("span",null,gt,":")," ",(0,t.createElement)("span",{className:"morning"})," ",(0,t.createElement)("span",{className:"afternoon"})),(0,t.createElement)("li",{className:"fri"},(0,t.createElement)("span",null,ft,":")," ",(0,t.createElement)("span",{className:"morning"})," ",(0,t.createElement)("span",{className:"afternoon"})),(0,t.createElement)("li",{className:"sat"},(0,t.createElement)("span",null,yt,":")," ",(0,t.createElement)("span",{className:"morning"})," ",(0,t.createElement)("span",{className:"afternoon"})),(0,t.createElement)("li",{className:"sun"},(0,t.createElement)("span",null,kt,":")," ",(0,t.createElement)("span",{className:"morning"})," ",(0,t.createElement)("span",{className:"afternoon"})))),(0,t.createElement)("p",{style:{display:"none"}},(0,t.createElement)("strong",null,wt),(0,t.createElement)("br",null),(0,t.createElement)("span",{className:"info-email"}),(0,t.createElement)("br",null),(0,t.createElement)("span",{className:"info-phone"})),(0,t.createElement)("a",{href:"#",className:"button select-terminal","data-method":"wc_shipping_"+this.props.provider+"_parcels_terminal"},lt)))))))}}const{pickup_location_ajax_url:bt,pickup_location_ajax_nonce:_t,pickup_location_select_choose_option:Dt,pickup_location_select_search:Et}=(0,n.getSetting)("german-market-blocks_data");function St(e){var t=document.createEvent("MouseEvents");t.initEvent("click",!0,!1),e.dispatchEvent(t)}function xt(e){var t=document.createEvent("HTMLEvents");t.initEvent("change",!0,!1),e.dispatchEvent(t)}function Mt(e,t){return null!=e?e.getAttribute(t):""}function Nt(e,t){return!!e&&e.classList.contains(t)}function Ct(e,t){if(e)return e.classList.add(t)}function Ot(e,t){if(e)return e.classList.remove(t)}var Lt={data:null,searchable:!1};function At(e,t){this.el=e,this.config=Object.assign({},Lt,t||{}),this.data=this.config.data,this.selectedOptions=[],this.placeholder=Mt(this.el,"placeholder")||this.config.placeholder||Dt,this.dropdown=null,this.multiple=Mt(this.el,"multiple"),this.disabled=Mt(this.el,"disabled"),this.create()}At.prototype.create=function(){this.el.style.display="none",this.data?this.processData(this.data):this.extractData(),this.renderDropdown(),this.bindEvent()},At.prototype.processData=function(e){var t=[],i=this;e.forEach((function(e){t.push({data:e,attributes:{selected:i.config.state.selectedLocation==e.value,disabled:!!e.disabled,optgroup:"optgroup"==e.value}})})),this.options=t},At.prototype.extractData=function(){var e=this.el.querySelectorAll("option,optgroup"),t=[],i=[],a=[],n=this;e.forEach((e=>{if("OPTGROUP"==e.tagName)var a={text:e.label,value:"optgroup"};else{let t=e.innerText;null!=e.dataset.display&&(t=e.dataset.display),a={text:t,value:e.value,selected:n.config.state.selectedLocation==e.value,disabled:null!=e.getAttribute("disabled"),cod:e.getAttribute("data-cod"),company:e.getAttribute("data-company"),address:e.getAttribute("data-address"),postcode:e.getAttribute("data-postcode"),city:e.getAttribute("data-city"),country:e.getAttribute("data-country")}}var s={selected:n.config.state.selectedLocation==e.value,disabled:null!=e.getAttribute("disabled"),optgroup:"OPTGROUP"==e.tagName};t.push(a),i.push({data:a,attributes:s})})),this.data=t,this.options=i,this.options.forEach((function(e){e.attributes.selected&&a.push(e)})),this.selectedOptions=a},At.prototype.renderDropdown=function(){var e=["german-market-blocks","advanced-select",Mt(this.el,"class")||"",this.disabled?"disabled":"",this.multiple?"has-multiple":""];let t=`<div class="advanced-select-search-box">\n<input type="text" class="advanced-select-search" placeholder="${Et}"/>\n</div>`;var i=`<div class="${e.join(" ")}" tabindex="${this.disabled?null:0}">\n  <span class="${this.multiple?"multiple-options":"current"}"></span>\n  <div class="advanced-select-dropdown">\n  ${this.config.searchable?t:""}\n  <ul class="list"></ul>\n  </div></div>\n`;this.el.insertAdjacentHTML("afterend",i),this.dropdown=this.el.nextElementSibling,this._renderSelectedItems(),this._renderItems()},At.prototype._renderSelectedItems=function(){var e=this.selectedOptions.length>0&&!0!==this.selectedOptions[0].attributes.optgroup?this.selectedOptions[0].data.text:this.placeholder;this.dropdown.querySelector(".current").innerHTML=e},At.prototype._renderItems=function(){var e=this.dropdown.querySelector("ul");this.options.forEach((t=>{e.appendChild(this._renderItem(t))}))},At.prototype._renderItem=function(e){var t=document.createElement("li");if(t.innerHTML=e.data.text,null!=e.data.address&&(t.innerHTML+='<span class="address">'+e.data.address+"</span>"),e.attributes.optgroup)Ct(t,"group");else{t.setAttribute("data-value",e.data.value),t.setAttribute("data-cod",e.data.cod),t.setAttribute("data-company",e.data.company),t.setAttribute("data-address",e.data.address),t.setAttribute("data-postcode",e.data.postcode),t.setAttribute("data-city",e.data.city),t.setAttribute("data-country",e.data.country);var i=["option",e.attributes.selected?"selected":null,e.attributes.disabled?"disabled":null];t.addEventListener("click",this._onItemClicked.bind(this,e)),t.classList.add(...i)}return e.element=t,t},At.prototype.update=function(){setTimeout((()=>{if(this.extractData(),this.dropdown){var e=Nt(this.dropdown,"open");null!==this.dropdown.parentNode&&this.dropdown.parentNode.removeChild(this.dropdown),this.create(),e&&St(this.dropdown)}}),250)},At.prototype.disable=function(){this.disabled||(this.disabled=!0,Ct(this.dropdown,"disabled"))},At.prototype.enable=function(){this.disabled&&(this.disabled=!1,Ot(this.dropdown,"disabled"))},At.prototype.clear=function(){this.selectedOptions=[],this._renderSelectedItems(),this.updateSelectValue(),xt(this.el)},At.prototype.destroy=function(){this.dropdown&&(this.dropdown.parentNode.removeChild(this.dropdown),this.el.style.display="")},At.prototype.bindEvent=function(){this.dropdown.addEventListener("click",this._onClicked.bind(this)),this.dropdown.addEventListener("keydown",this._onKeyPressed.bind(this)),window.addEventListener("click",this._onClickedOutside.bind(this)),this.config.searchable&&this._bindSearchEvent()},At.prototype._bindSearchEvent=function(){var e=this.dropdown.querySelector(".advanced-select-search");e&&e.addEventListener("click",(function(e){return e.stopPropagation(),!1})),e.addEventListener("input",this._onSearchChanged.bind(this))},At.prototype._onClicked=function(e){if(this.dropdown.classList.toggle("open"),this.dropdown.classList.contains("open")){var t=this.dropdown.querySelector(".advanced-select-search");t&&(t.value="",t.focus());var i=this.dropdown.querySelector(".focus");Ot(i,"focus"),Ct(i=this.dropdown.querySelector(".selected"),"focus"),this.dropdown.querySelectorAll("ul li").forEach((function(e){e.style.display=""}))}else this.dropdown.focus()},At.prototype._onItemClicked=function(e,t){var i=t.target;if("SPAN"==i.nodeName&&i.parentNode&&(i=i.parentNode),!Nt(i,"disabled")){this.selectedOptions.forEach((function(e){Ot(e.element,"selected")})),Ct(i,"selected"),this.selectedOptions=[e],this.config.state.selectedLocation=i.getAttribute("data-value");var a="wc_shipping_"+this.config.state.provider+"_parcels_terminal",n="choose_"+this.config.state.provider+"_terminal";fetch(bt.toString().replace("%%endpoint%%",n),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({action:n,is_backend_modal:!1,terminal_field:a,terminal:i.getAttribute("data-value"),terminal_details:{id:i.getAttribute("data-value"),company:i.getAttribute("data-company"),street:i.getAttribute("data-address"),pcode:i.getAttribute("data-postcode"),city:i.getAttribute("data-city")},cod:0,security:_t})}).then((e=>e.json())).then((e=>{this.config.state.updateHandler("pickup_location",e.terminal_id)}),(e=>{console.log(e)})),this._renderSelectedItems(),this.updateSelectValue()}},At.prototype.updateSelectValue=function(){this.multiple?this.selectedOptions.each((function(e){var t=this.el.querySelector('option[value="'+e.data.value+'"]');t&&t.setAttribute("selected",!0)})):this.selectedOptions.length>0&&(this.el.value=this.selectedOptions[0].data.value),xt(this.el)},At.prototype._onClickedOutside=function(e){this.dropdown.contains(e.target)||this.dropdown.classList.remove("open")},At.prototype._onKeyPressed=function(e){var t=this.dropdown.querySelector(".focus"),i=this.dropdown.classList.contains("open");if(32==e.keyCode||13==e.keyCode)St(i?t:this.dropdown);else if(40==e.keyCode){if(i){var a=this._findNext(t);a&&(Ot(this.dropdown.querySelector(".focus"),"focus"),Ct(a,"focus"))}else St(this.dropdown);e.preventDefault()}else if(38==e.keyCode){if(i){var n=this._findPrev(t);n&&(Ot(this.dropdown.querySelector(".focus"),"focus"),Ct(n,"focus"))}else St(this.dropdown);e.preventDefault()}else 27==e.keyCode&&i&&St(this.dropdown);return!1},At.prototype._findNext=function(e){for(e=e?e.nextElementSibling:this.dropdown.querySelector(".list .option");e;){if(!Nt(e,"disabled")&&"none"!=e.style.display)return e;e=e.nextElementSibling}return null},At.prototype._findPrev=function(e){for(e=e?e.previousElementSibling:this.dropdown.querySelector(".list .option:last-child");e;){if(!Nt(e,"disabled")&&"none"!=e.style.display)return e;e=e.previousElementSibling}return null},At.prototype._onSearchChanged=function(e){var t=this.dropdown.classList.contains("open"),i=e.target.value;if(""==(i=i.toLowerCase()))this.options.forEach((function(e){e.element.style.display=""}));else if(t){var a=new RegExp(i);this.options.forEach((function(e){var t=e.data.text.toLowerCase(),i=a.test(t);e.element.style.display=i?"":"none"}))}this.dropdown.querySelectorAll(".focus").forEach((function(e){Ot(e,"focus")})),Ct(this._findNext(null),"focus")};const{pickup_location_ajax_url:Tt,pickup_location_select_choose_option:Ft}=(0,n.getSetting)("german-market-blocks_data");class Vt extends t.Component{constructor(e){super(e),this.state={postcode:"",city:"",street:"",country:"",locationGroups:[],locations:{},locationType:this.props.locationType,selectedLocation:this.props.terminal,updateHandler:this.props.updateHandler,provider:"",el:{}}}componentDidMount(){let e=document.getElementById("wc_shipping_"+this.props.provider+"_terminals");this.state.el=function(e,t){return new At(e,t)}(e,{state:this.state,props:this.props})}componentDidUpdate=(e,t,i)=>{if(""===this.props.provider)return;if(null===this.state.el)return;let n="parcels";document.getElementById("wc_shipping_"+this.props.provider+"_terminals").classList.contains("packstation")&&(n="packstation");const o=(0,a.select)(s.CART_STORE_KEY).getCartData();let r=o.shippingAddress.postcode,l=o.shippingAddress.city,c=o.shippingAddress.address_1,d=o.shippingAddress.country;n===this.state.locationType&&this.state.postcode===r&&this.state.city===l&&this.state.street===c&&this.state.country===d&&0!=this.state.locations.length||""!==r&&""!==l&&""!==c&&(this.state.postcode=r,this.state.city=l,this.state.street=c,this.state.country=d,this.state.provider=this.props.provider,n!==this.state.locationType&&(this.state.locationType=n),this.loadLocations())};componentWillUnmount=()=>{};loadLocations=()=>{if(""===this.state.postcode&&""===this.state.street&&""===this.state.city)return console.log("address empty"),void this.setState({locations:{}});if(""===this.props.provider)return void console.log("Could not determinate shipping provider");let e="get_"+this.props.provider+"_parcels_modal";"packstation"===this.props.locationType&&(e="get_"+this.props.provider+"_packstations_modal");let t=this;fetch(Tt.toString().replace("%%endpoint%%",e),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({action:e,postcode:this.state.postcode,city:this.state.city,street:this.state.street,country:this.state.country,provider:this.props.provider,type:this.state.locationType,grouped:!0})}).then((e=>e.json())).then((e=>{this.setState({locations:e}),this.setState({locationGroups:Object.keys(e)}),t.state.el.update()}),(e=>{this.setState({locations:{}}),this.setState({locationGroups:[]}),console.log(e)}))};render(){return(0,t.createElement)("select",{id:"wc_shipping_"+this.props.provider+"_terminals",name:"wc_shipping_"+this.props.provider+"_terminals",className:this.props.locationType,placeholder:Ft,onChange:()=>{this.state.selectedLocation=this.value}},this.state.locationGroups&&this.state.locationGroups.map((e=>(0,t.createElement)("optgroup",{key:e,label:e,disabled:!0},this.state.locations[e]?.map((e=>(0,t.createElement)("option",{key:e.parcelshop_id,"data-cod":e.cod,"data-company":e.company,"data-address":e.street,"data-postcode":e.pcode,"data-city":this.state.city,"data-country":this.state.country,value:e.parcelshop_id},e.company)))))))}}Object.assign(Ze.locales,{de:{days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],daysShort:["So","Mo","Di","Mi","Do","Fr","Sa"],daysMin:["So","Mo","Di","Mi","Do","Fr","Sa"],months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],monthsShort:["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],today:"Heute",monthsTitle:"Monate",clear:"Löschen",weekStart:1,format:"dd.mm.yyyy"}});const{shipping_label:Bt,datepicker_language:qt,delivery_day_label:Ht,delivery_day_fee_text:It,delivery_day_min_date:jt,delivery_day_max_date:Yt,delivery_day_value:Kt,delivery_day_enabled:Wt,date_of_birth_label:Rt,date_of_birth_value:Pt,date_of_birth_min_date:$t,date_of_birth_max_date:Jt,date_of_birth_required:Ut,date_of_birth_error_text:Gt,client_number_label:zt,client_number_required:Zt,client_number_error_text:Xt,pickup_location_ajax_url:Qt,pickup_location_text:ei,pickup_location_google_map_key_dhl:ti,pickup_location_google_map_key_dpd:ii,pickup_location_map_available:ai,pickup_location_selected_id:ni,pickup_location_selected_address:si,pickup_location_dhl_client_id:oi,empty_additional_shipping_text:ri}=(0,n.getSetting)("german-market-blocks_data"),li=JSON.parse('{"apiVersion":2,"name":"german-market/woocommerce-shipping","version":"2.0.0","title":"Additional Shipping Information","category":"german-market","description":"Adds the German Market block to enter a date of birth, client number and select a parcel shop or packstation","supports":{"html":false,"align":false,"multiple":false,"reusable":true,"lock":false},"parent":["woocommerce/checkout-fields-block"],"textdomain":"woocommerce-german-market"}');(0,e.registerCheckoutBlock)({metadata:li,component:({cart:n,checkoutExtensionData:o,extensions:r,children:l})=>{const{setExtensionData:c}=o,d=(0,i.useCallback)((0,Xe.debounce)(((e,t,i)=>{c(e,t,i)}),1e3),[c]),{setValidationErrors:p,clearValidationError:h}=(0,a.useDispatch)("wc/store/validation"),{dateOfBirthValidationError:u,clientNumberValidationError:m}=(0,a.useSelect)((e=>{const t=e("wc/store/validation");return{dateOfBirthValidationError:t.getValidationError("german-market-shipping-date-of-birth"),clientNumberValidationError:t.getValidationError("german-market-shipping-client-number")}})),[g,f]=(0,i.useState)(oi),[y,k]=(0,i.useState)(Pt),[w,v]=(0,i.useState)(Kt),[b,_]=(0,i.useState)(!1),[D,E]=(0,i.useState)(!1),[S,x]=(0,i.useState)(!1),[M,N]=(0,i.useState)(null),[C,O]=(0,i.useState)(""),[L,A]=(0,i.useState)("parcels"),[T,F]=(0,i.useState)(ni),[V,B]=(0,i.useState)(si);if((0,i.useEffect)((()=>{c("german-market-shipping-store-api-integration","delivery_day",w),d("german-market-shipping-store-api-integration","delivery_day",w),c("german-market-shipping-store-api-integration","date_of_birth",y),d("german-market-shipping-store-api-integration","date_of_birth",y),Ut&&""!=y&&h("german-market-shipping-date-of-birth"),c("german-market-shipping-store-api-integration","client_number",g),d("german-market-shipping-store-api-integration","client_number",g),Zt&&""!=g&&h("german-market-shipping-client-number"),c("german-market-shipping-store-api-integration","location_id",T),d("german-market-shipping-store-api-integration","location_id",T)}),[w,y,g,T]),document.getElementById("german-market-shipping-delivery-day")&&null===document.querySelector("#german-market-shipping-delivery-day + .datepicker")){var q=document.getElementById("german-market-shipping-delivery-day"),H=new Ze(q,{autohide:!0,showOnClick:!0,showOnFocus:!0,clearBtn:!0,weekStart:1,daysOfWeekDisabled:[0],minDate:new Date(jt),maxDate:new Date(Yt),format:"yyyy-mm-dd",language:qt});q.addEventListener("show",(e=>{var t=document.getElementById("german-market-shipping-delivery-day").value;""==t&&(H.setFocusedDate(new Date(jt)),H.setDate(t),H.dates=[],null!==document.querySelector("#german-market-shipping-delivery-day + .datepicker .selected")&&document.querySelector("#german-market-shipping-delivery-day + .datepicker .selected").classList.remove("selected"))})),q.addEventListener("changeDate",(e=>{var t=void 0!==H.getDate()?H.getDate("yyyy-mm-dd"):"";v(t),P("delivery_day",t),q.blur()}))}if(document.getElementById("german-market-shipping-date-of-birth")&&null===document.querySelector("#german-market-shipping-date-of-birth + .datepicker")){var I=document.getElementById("german-market-shipping-date-of-birth"),j=new Ze(I,{autohide:!0,showOnClick:!0,showOnFocus:!0,clearBtn:!0,weekStart:1,minDate:new Date($t),maxDate:new Date(Jt),format:"yyyy-mm-dd",language:qt});I.addEventListener("changeDate",(e=>{var t=void 0!==j.getDate()?j.getDate("yyyy-mm-dd"):"";k(t),I.blur()}))}let Y=document.querySelector("#shipping-option input[type=radio]:checked");if(null!==Y){let e=Y.value;e!=M&&(e.includes("dhl_home_delivery")?(E(Wt),x(Ut),_(!1),A("")):e.includes("dhl_packstation")?(E(Wt),x(!1),_(!0),O("dhl"),A("packstation")):e.includes("dhl_parcelshops")?(E(Wt),x(Ut),_(!0),O("dhl"),A("parcels")):(E(!1),x(!1),_(!1),O(""),A("")),N(e))}(0,i.useEffect)((()=>{let e=document.querySelector("#shipping-option input[type=radio]:checked");if(null!==e){let t=e.value;t.includes("dhl_home_delivery")?A(""):t.includes("dhl_packstation")?A("packstation"):t.includes("dhl_parcelshops")?A("parcels"):(A(""),v(""),P("delivery_day",""))}if(""!==C){let e="get_"+C+"_selected_terminal_info";fetch(Qt.toString().replace("%%endpoint%%",e),{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({action:e,type:L})}).then((e=>e.json())).then((e=>{B(e.terminal_address),F(e.terminal_id)}),(e=>{console.log(e)}))}}),[M]);const{__internalSetUseShippingAsBilling:K}=(0,a.dispatch)(s.CHECKOUT_STORE_KEY),W=document.querySelector(".wc-block-checkout__use-address-for-billing"),R=document.querySelector('.wc-block-checkout__use-address-for-billing input[type="checkbox"]');(0,i.useEffect)((()=>{if(null!==Y){let e=Y.value;e.includes("dhl_packstation")||e.includes("dhl_parcelshops")?(R.checked&&R.click(),R.disabled=!0,W.style.opacity=.6):e.includes("dhl_packstation")||e.includes("dhl_parcelshops")||(R.disabled=!1,W.style.opacity=1)}}),[{__internalSetUseShippingAsBilling:K}]);const P=(t,i)=>{(0,e.extensionCartUpdate)({namespace:"german-market-blocks-shipping",data:{[t]:i}}).then((e=>{}))};return(0,t.createElement)("fieldset",{className:"wc-block-checkout__shipping-option wp-block-woocommerce-checkout-shipping-methods-block wc-block-components-checkout-step wc-block-components-checkout-step--with-step-number"},(0,t.createElement)("legend",{className:"screen-reader-text"},Bt),(0,t.createElement)("div",{className:"wc-block-components-checkout-step__heading"},(0,t.createElement)("h2",{className:"wc-block-components-title wc-block-components-checkout-step__title","aria-hidden":"true"},Bt)),(0,t.createElement)("div",{className:"wc-block-components-checkout-step__container"},(0,t.createElement)("div",{className:"wc-block-components-checkout-step__content"},(0,t.createElement)("div",{className:"wc-block-components-checkout-step__container"},(0,t.createElement)("div",{className:"wc-block-components-checkout-step__content"},(0,t.createElement)("div",{className:"german-market-shipping-input-delivery-day",style:{display:D?"":"none"}},(0,t.createElement)(e.ValidatedTextInput,{className:"hasDatepicker",id:"german-market-shipping-delivery-day",label:Ht,value:w,readOnly:!0,onChange:e=>{v(e),P("delivery_day",e)},errorId:"german-market-shipping-delivery-day"}),(0,t.createElement)("div",{dangerouslySetInnerHTML:{__html:It}})),(0,t.createElement)("div",{className:"german-market-shipping-input-date-of-birth",style:{display:S?"":"none"}},(0,t.createElement)(e.ValidatedTextInput,{className:"",id:"german-market-shipping-date-of-birth",label:Rt+(S?" *":""),value:y,required:S,onFocus:()=>{h("german-market-shipping-date-of-birth")},onChange:e=>!1,customValidation:e=>!0===S&&""==e.value?(p({"german-market-shipping-date-of-birth":{message:Gt,hidden:!1}}),!1):(h("german-market-shipping-date-of-birth"),!0),errorId:"german-market-shipping-date-of-birth"})),(0,t.createElement)("div",{className:"german-market-shipping-input-client-number",style:{display:b?"":"none"}},(0,t.createElement)(e.ValidatedTextInput,{className:"",id:"german-market-shipping-client-number",label:zt+(b?" *":""),value:g,required:b,onFocus:e=>{h("german-market-shipping-client-number")},onChange:e=>{f(e)},customValidation:e=>!0===b&&""==e.value?(p({"german-market-shipping-client-number":{hidden:!1}}),!1):(h("german-market-shipping-client-number"),!0),errorId:"german-market-shipping-client-number"})),(0,t.createElement)("div",{className:"german-market-shipping-select-pickup-location",style:{display:b?"":"none"}},(0,t.createElement)("div",null,ei),(0,t.createElement)("div",null,ai&&(0,t.createElement)(vt,{setTerminal:F,provider:C,locationType:L,googleMapKey:"dhl"===C?ti:ii,updateHandler:P,locationInfo:V}),!ai&&(0,t.createElement)(Vt,{terminal:T,setTerminal:F,provider:C,locationType:L,updateHandler:P}))),(0,t.createElement)("div",{style:{display:b||S||D?"none":"block"}},(0,t.createElement)("p",null,ri)))))))}})})();