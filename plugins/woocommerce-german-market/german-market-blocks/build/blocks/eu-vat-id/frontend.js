(()=>{"use strict";const e=window.wc.blocksCheckout,t=window.React,a=window.wp.element,n=window.wp.data,r=JSON.parse('{"apiVersion":2,"name":"german-market/eu-vat-id","version":"2.0.0","title":"German Market EU VAT ID Check","category":"german-market","description":"Adds the German Market EU VAT ID Check to the checkout","supports":{"html":false,"align":false,"multiple":false,"reusable":true,"lock":false},"parent":["woocommerce/checkout-fields-block","woocommerce/checkout-totals-block"],"textdomain":"woocommerce-german-market"}');(0,e.registerCheckoutBlock)({metadata:r,component:({cart:r,checkoutExtensionData:o,extensions:i,children:s})=>{const{setValidationErrors:c,clearValidationError:l}=(0,n.useDispatch)("wc/store/validation"),m="german-market-eu-vat-id",{setExtensionData:d}=o;let u="",p="",g=!1,k=!1,_="",v="",h="",b="",E="",w="",f="";i["german-market-store-api-integration"]&&(E=i["german-market-store-api-integration"].vat_id_data.default_value,k=i["german-market-store-api-integration"].vat_id_data.required,g=i["german-market-store-api-integration"].vat_id_data.show,p=i["german-market-store-api-integration"].vat_id_data.label,u=i["german-market-store-api-integration"].vat_id_data.country,h=i["german-market-store-api-integration"].vat_id_data.required_error_if_empty,b=i["german-market-store-api-integration"].vat_id_data.validating,v=i["german-market-store-api-integration"].vat_id_data.last_error,w=i["german-market-store-api-integration"].vat_id_data.is_success,f=i["german-market-store-api-integration"].vat_id_data.last_validated_number,_=v&&""!==v?i["german-market-store-api-integration"].vat_id_data.default_error:""),k&&(p+=" *");const[y,x]=(0,a.useState)(E);let N=!1;w&&f===y&&(N=!0);let C=document.getElementById(m),A=!1;C&&(A=!0,C.parentElement.setAttribute("data-validating-string",b),N&&(C.parentElement.classList.contains("validating")||C.parentElement.classList.add("validation-success")));const V=e=>{d("german-market-eu-vat-id-store-api-integration","billing_vat",e)};(0,a.useEffect)((()=>{x(E),V(E)}),[E]),(0,a.useEffect)((()=>{B()}),[A]);const L=()=>{let e=document.getElementsByClassName("wc-block-components-checkout-place-order-button");Array.prototype.forEach.call(e,(function(e){e.setAttribute("disabled",!0)}))},B=()=>{C&&(C.parentElement.classList.add("validating"),C.parentElement.classList.remove("validation-success")),L(),""!==y&&l(m),(0,e.extensionCartUpdate)({namespace:"german-market-blocks-eu-vat-id",data:{show:g,country:u,vat_number:y}}).then((e=>{(()=>{let e=document.getElementsByClassName("wc-block-components-checkout-place-order-button");Array.prototype.forEach.call(e,(function(e){e.removeAttribute("disabled")}))})(),C&&(C.parentElement.classList.remove("validating"),w=e.extensions["german-market-store-api-integration"].vat_id_data.is_success,f=e.extensions["german-market-store-api-integration"].vat_id_data.last_validated_number,w&&f===y&&(N=!0),N&&C.parentElement.classList.add("validation-success")),v=e.extensions["german-market-store-api-integration"].vat_id_data.last_error,_=v&&""!==v?e.extensions["german-market-store-api-integration"].vat_id_data.default_error:"",""!==_&&c({[m]:{message:_,hidden:!1}})}))};(0,a.useEffect)((()=>{B(),g||V("")}),[g,u]);(0,a.useEffect)((()=>{""===_?""!==_||k||l(m):c({[m]:{message:_,hidden:!1}})}),[_,c,l]);let D=(0,t.createElement)(t.Fragment,null);return g&&(D=(0,t.createElement)(t.Fragment,null,(0,t.createElement)("fieldset",{className:"wc-block-checkout__shipping-option wp-block-woocommerce-checkout-shipping-methods-block wc-block-components-checkout-step wc-block-components-checkout-step--with-step-number"},(0,t.createElement)("legend",{className:"screen-reader-text"},p),(0,t.createElement)("div",{className:"wc-block-components-checkout-step__heading"},(0,t.createElement)("h2",{className:"wc-block-components-title wc-block-components-checkout-step__title","aria-hidden":"true"},p)),(0,t.createElement)("div",{className:"wc-block-components-checkout-step__container"},(0,t.createElement)("div",{className:"wc-block-components-checkout-step__content"},(0,t.createElement)(e.ValidatedTextInput,{className:"billing_vat german-market-billing-vat-block",id:m,label:p,value:y,required:!1,onChange:e=>{V(e),C&&C.parentElement.classList.remove("validation-success"),x(e)},onBlur:()=>{B()},onFocus:L,errorId:m,customValidation:e=>!k||""!=e.value||(e.setCustomValidity(h),!1)})))))),D}})})();