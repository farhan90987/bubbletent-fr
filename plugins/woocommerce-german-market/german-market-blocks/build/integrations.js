(()=>{"use strict";const e=window.wc.blocksCheckout,t=window.wc.wcSettings,a=window.wp.data;(0,e.registerCheckoutFilters)("myTaxOutput",{cartItemPrice:(e,t,a)=>{if("cart"!==a?.context&&"summary"!==a?.context)return e;let n="",o=a.cartItem.item_data;if(o){let e=o.find((e=>"_gm_line_item_tax"===e.key));e&&(n=e.value)}return""!==n&&(e=e+" "+n),e},subtotalPriceFormat:(e,t,a)=>{if("cart"!==a?.context&&"summary"!==a?.context)return e;let n="",o=a.cartItem.item_data;if(o){let e=o.find((e=>"_gm_ppu"===e.key));e&&(n=e.value)}return""!==n&&(e=e+" "+n),e},placeOrderButtonLabel:(e,a,n)=>{const o=(0,t.getSetting)("german-market-blocks_data");if(o.woocommerce_de_order_button_text){const t=o.woocommerce_de_order_button_text;""!==t&&(e=t)}return e}});const n=window.React,o=window.wp.plugins,r=({cart:e,extensions:a,context:o})=>{let r="",c=(0,t.getSetting)("german-market-blocks_data");return c.woocommerce_de_estimate_cart&&"on"===c.woocommerce_de_estimate_cart&&"woocommerce/cart"===o&&(r=(0,n.createElement)("div",{className:"wc-block-components-totals-item"},(0,n.createElement)("p",{className:"wc-cart-shipping-notice"},(0,n.createElement)("small",{dangerouslySetInnerHTML:{__html:c.woocommerce_de_estimate_cart_text}})))),r},c=({context:e})=>{let a="",o=(0,t.getSetting)("german-market-blocks_data");return o.manual_order_confirmation_payment_methods_show_text&&"on"===o.manual_order_confirmation_payment_methods_show_text&&"woocommerce/checkout"===e&&(a=(0,n.createElement)("div",{className:"wc-block-components-totals-item"},(0,n.createElement)("p",{className:"german-market-manual-confirmation-payment-info"},(0,n.createElement)("small",null,o.manual_order_confirmation_payment_methods_hint_text)))),a},s=({cart:e,extensions:t,context:a})=>{let o=[],r="",c="";t["german-market-store-api-integration"]&&(o=t["german-market-store-api-integration"].shipping_tax_strings,r=t["german-market-store-api-integration"].cart_total_tax,c=t["german-market-store-api-integration"].cart_shipping_total_string);let s="";return Object.keys(o).forEach((e=>{for(let t=0;t<=20;t++)s+="span#radio-control-"+t+"-"+e.replace(":","\\:")+"__description:after{ content: '"+o[e]+"'; white-space: pre-wrap; } ",s+="#radio-control-"+t+"-"+e.replace(":","\\:")+"__secondary-label .wc-block-formatted-money-amount:after{ content: '"+o[e]+"'; white-space: pre-wrap; font-size: small; } "})),""!=r&&(s+=" .wc-block-components-totals-footer-item-tax{ display: none; }",s+=" .wc-block-components-totals-footer-item .wc-block-components-totals-item__description .wc-block-components-totals-footer-item-tax {display: none; }",s+=" .wc-block-components-totals-footer-item .wc-block-components-totals-item__description:after{ content: '"+r+"'; white-space: pre-wrap; font-size: small; display: block; text-align: right; }"),""!=c&&(s+=" .wc-block-components-totals-shipping .wc-block-components-totals-item .wc-block-components-totals-item__value{ text-align: right; }",s+=" .wc-block-components-totals-shipping .wc-block-components-totals-item .wc-block-components-totals-item__value:after{ content: '"+c+"' !important; white-space: pre-wrap; font-size: small; display: block; text-align: right; font-weight: normal; }",s+=" .wc-block-components-totals-shipping .wc-block-components-totals-item .wc-block-components-totals-item__value, .wc-block-components-totals-fees.wc-block-components-totals-item .wc-block-components-totals-item__value { flex-grow: 1; }"),(0,n.createElement)(n.Fragment,null,(0,n.createElement)("style",null,s))},i=window.wp.element,l=window.wc.wcBlocksData,m=({cart:o,extensions:r,context:c})=>{let s=[];r["german-market-store-api-integration"]&&(s=r["german-market-store-api-integration"].fees);const{activePaymentMethod:m}=(0,a.useSelect)((e=>({activePaymentMethod:e(l.PAYMENT_STORE_KEY).getActivePaymentMethod()})));let _=o.cartFees,p=document.getElementsByClassName("wc-block-components-totals-item__label");Array.prototype.forEach.call(p,(function(e){let t=e.innerHTML;Object.keys(s).forEach((a=>{if(s[a].name===t){e.innerHTML=e.innerHTML;let t=s[a].id;e.parentElement.classList.add("german-market-fee-"+t)}}))}));let g="";Object.keys(s).forEach((e=>{let t=s[e].id;g+=".german-market-fee-"+t+" .wc-block-formatted-money-amount:after{ content: '"+s[e].tax_info+"'; white-space: pre-wrap; font-size: small; font-weight: normal; display: block; } ",g+=".german-market-fee-"+t+" .wc-block-formatted-money-amount{ text-align: right; }"})),(0,i.useEffect)((()=>{let a=(0,t.getSetting)("german-market-blocks_data");a.use_extension_cart_update_in_gateway_tax_info_fees&&"yes"===a.use_extension_cart_update_in_gateway_tax_info_fees&&(0,e.extensionCartUpdate)({namespace:"german-market-update-fee-taxes",data:{fees:_}})}),[g]);let d=null;return""!=g&&(d=(0,n.createElement)("style",null,g)),d};(0,o.registerPlugin)("german-market-blocks",{render:()=>(0,n.createElement)(n.Fragment,null,(0,n.createElement)(e.ExperimentalOrderMeta,null,(0,n.createElement)(r,null),(0,n.createElement)(c,null),(0,n.createElement)(s,null),(0,n.createElement)(m,null))),scope:"woocommerce-checkout"}),(0,window.wc.wcBlocksRegistry.registerPaymentMethodExtensionCallbacks)("german-market-gateway-visibility",{german_market_purchase_on_account:e=>{let t=!0;return e.cart.extensions["german-market-store-api-integration"]&&(t=e.cart.extensions["german-market-store-api-integration"].purchase_on_account_visibility),t},german_market_sepa_direct_debit:e=>{let t=!0;return e.cart.extensions["german-market-store-api-integration"]&&(t=e.cart.extensions["german-market-store-api-integration"].sepa_visibility),t}});const _=()=>{const{__internalSetUseShippingAsBilling:e}=(0,a.dispatch)("wc/store/checkout");return(0,i.useEffect)((()=>{e(!0)}),[{__internalSetUseShippingAsBilling:e}]),null};(0,o.registerPlugin)("german-market-blocks-purchase-on-account-trigger",{render:()=>{let e="";if("yes"===(0,t.getSetting)("german_market_purchase_on_account_data",{}).deactivate_ship_to_different_address){const{activePaymentMethod:t}=(0,a.useSelect)((e=>({activePaymentMethod:e(l.PAYMENT_STORE_KEY).getActivePaymentMethod()}))),o=document.getElementsByClassName("wc-block-checkout__use-address-for-billing");"german_market_purchase_on_account"===t?(e=(0,n.createElement)(_,null),o.length&&o[0].classList.add("german-market__hide-use-address-for-billing")):o.length&&o[0].classList.remove("german-market__hide-use-address-for-billing")}return e},scope:"woocommerce-checkout"});const p=()=>{const{activePaymentMethod:n}=(0,a.useSelect)((e=>({activePaymentMethod:e(l.PAYMENT_STORE_KEY).getActivePaymentMethod()}))),o="german_market_purchase_on_account"===n;(0,i.useEffect)((()=>{let a=(0,t.getSetting)("german-market-blocks_data");a.use_extension_cart_update_in_gateway_fees&&"yes"===a.use_extension_cart_update_in_gateway_fees&&(0,e.extensionCartUpdate)({namespace:"german-market-blocks-gateway-fees",data:{germanMarketActivePaymentMethod:n}})}),[o,n])};(0,o.registerPlugin)("german-market-blocks-gateway-fees",{render:()=>(0,n.createElement)(p,null),scope:"woocommerce-checkout"})})();